### üê± ÂïÜÂìÅ„ÇíËøΩÂä†„Åó„Çà„ÅÜ!

„Ç™„É≥„É©„Ç§„É≥„Ç∑„Éß„ÉÉ„Éó„ÅÆÂÆåÊàê„ÅØÈñìËøë„Åß„Åô!

„Åï„ÅÑ„Åî„Å´„ÄÅ„Ç∑„Éß„ÉÉ„Éó„ÅÆ„Ç™„Éº„Éä„Éº„Åß„ÅÇ„Çã„ÅÇ„Å™„Åü„Åå **„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Åã„Çâ** „Ç∑„Éß„ÉÉ„Éó„Å´„Ç¢„Ç§„ÉÜ„É†„ÇíËøΩÂä†„Åß„Åç„ÇãÊ©üËÉΩ„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ

„Åæ„Åö„ÄÅ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ„É´„Éº„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™„Å´`.env.local`„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„ÄÅ„Åù„Åì„Å´„Ç¢„Éâ„É¨„Çπ„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ

ÁßÅ„ÅÆÂ†¥Âêà„ÄÅ`.env.local`„Éï„Ç°„Ç§„É´„ÅØ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ

```
// .env.local
NEXT_PUBLIC_OWNER_PUBLIC_KEY=2TmQsWGFh5vhqJdDrG6uA2MRstGrUwUCiiThyHL9HaMe
```

> ‚ö†Ô∏è Ê≥®ÊÑè
>
> Next.js „Å´„ÅØ [dotenv](https://www.dotenv.org/) „ÅåÁµÑ„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅenv Â§âÊï∞Âêç„Çí`NEXT_PUBLIC`„Åã„Çâ„ÅØ„Åò„ÇÅ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
>
> „Åæ„Åü„ÄÅ`.env.local`„Å∏„ÅÆÂ§âÊõ¥„ÇíÂèçÊò†„Åï„Åõ„Çã„Åü„ÇÅ„Å´„ÅØ„ÄÅNext.js „ÇíÂÜçËµ∑ÂãïÔºà`CTR + C`„Åß‰∏ÄÊó¶ÂÅúÊ≠¢„Åï„Åõ„ÄÅ`yarn dev`„ÅßÂÜç„Å≥Á´ã„Å°‰∏ä„Åí„ÇãÔºâ„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

„Åù„Çå„Åß„ÅØ„ÄÅ`components`„Éï„Ç©„É´„ÉÄ„Å´`CreateProduct.js`„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„Å¶‰ª•‰∏ã„ÅÆ„Ç≥„Éº„Éâ„ÇíË≤º„Çä‰ªò„Åë„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

```jsx
// CreateProduct.js

import { create } from 'ipfs-http-client';
import { useState } from 'react';

import styles from '../styles/CreateProduct.module.css';

const client = create('https://ipfs.infura.io:5001/api/v0');

const CreateProduct = () => {

  const [newProduct, setNewProduct] = useState({
    name: '',
    price: '',
    imageUrl: '',
    description: '',
  });
  const [file, setFile] = useState({});
  const [uploading, setUploading] = useState(false);

  async function onChange(e) {
    setUploading(true);
    const files = e.target.files;
    try {
      console.log(files[0]);
      const added = await client.add(files[0]);
      setFile({ filename: files[0].name, hash: added.path });
    } catch (error) {
      console.log('Error uploading file: ', error);
    }
    setUploading(false);
  }

  const createProduct = async () => {
    try {
      // ÂïÜÂìÅ„Éá„Éº„Çø„Å®file.name„ÇíÁµêÂêà„Åó„Åæ„Åô„ÄÇ
      const product = { ...newProduct, ...file };
      console.log('Sending product to api',product);
      const response = await fetch('../api/addProduct', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(product),
      });
      if (response.status === 200) {
        alert('Product added!');
      }
      else{
        const data = await response.json();
        alert('Unable to add product: ', data.error);
      }

    } catch (error) {
      console.log(error);
    }
  };

  return (
    <div className={styles.background_blur}>
      <div className={styles.create_product_container}>
        <div className={styles.create_product_form}>
          <header className={styles.header}>
            <h1>Create Product</h1>
          </header>

          <div className={styles.form_container}>
            <input
              type="file"
              className={styles.input}
              accept=".jpg,.png"
              placeholder="Images"
              onChange={onChange}
            />
            {file.name != null && <p className="file-name">{file.filename}</p>}
            <div className={styles.flex_row}>
              <input
                className={styles.input}
                type="text"
                placeholder="Product Name"
                onChange={(e) => {
                  setNewProduct({ ...newProduct, name: e.target.value });
                }}
              />
              <input
                className={styles.input}
                type="text"
                placeholder="0.01 USDC"
                onChange={(e) => {
                  setNewProduct({ ...newProduct, price: e.target.value });
                }}
              />
            </div>

            <div className={styles.flex_row}>
              <input
                className={styles.input}
                type="url"
                placeholder="Image URL ex: https://media.giphy.com/media/FWAcpJsFT9mvrv0e7a/giphy.gif"
                onChange={(e) => {
                  setNewProduct({ ...newProduct, imageUrl: e.target.value });
                }}
              />
            </div>
            <textarea
              className={styles.text_area}
              placeholder="Description here..."
              onChange={(e) => {
                setNewProduct({ ...newProduct, description: e.target.value });
              }}
            />

            <button
              className={styles.button}
              onClick={() => {
                createProduct();
              }}
              disabled={uploading}
            >
              Create Product
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

export default CreateProduct;
```

### ‚úÖ „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅÆÂãï‰ΩúÁ¢∫Ë™ç

`CreateProduct`„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÇíÂÆüË£Ö„Åó„Åü„ÅÆ„Åß„ÄÅ„ÉÜ„Çπ„Éà„Çπ„ÇØ„É™„Éó„Éà„ÇíÂÆüË°å„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ

Á∞°Âçò„Å´„ÉÜ„Çπ„ÉàÂÜÖÂÆπ„ÇíË™¨Êòé„Åó„Åæ„Åô„ÄÇ`__tests__/CreateProduct.test.js`„Åß„ÅØ„ÄÅ**„Ç¢„Ç§„ÉÜ„É†ËøΩÂä†„ÅÆÊàêÂäü„ÉªÂ§±Êïó„Å´Âøú„Åò„Å¶ÊúüÂæÖ„Åô„Çã„Ç¢„É©„Éº„Éà„ÅåÂÆüË°å„Åï„Çå„Çã„Åã**„Çí„ÉÜ„Çπ„Éà„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ

Buy„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅÆ„ÉÜ„Çπ„ÉàÂêåÊßò„ÄÅÂãï‰ΩúÁ¢∫Ë™ç„ÇíË°å„ÅÑ„Åü„ÅÑ„Çπ„ÉÜ„Éº„Çø„Çπ„Å´ÂØæÂøú„Åô„ÇãÊàª„ÇäÂÄ§„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ

```javascript
// __tests__/CreateProduct.test.js
const addedProductMock = () => {
  return Promise.resolve({
    status: 200,
    json: () => Promise.resolve({}),
  });
};

const errorAddedProductMock = () => {
  return Promise.resolve({
    status: 500,
    json: () => Promise.resolve({ error: 'error' }),
  });
};
```

ÊàêÂäü„Çπ„ÉÜ„Éº„Çø„Çπ„Çí„ÉÜ„Çπ„Éà„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅ‰∏ãË®ò„ÅÆ„Çà„ÅÜ„Å´„Éï„Ç©„Éº„É†Ë¶ÅÁ¥†„ÇíÂèñÂæó„Åó„Å¶„ÄÅÂÄ§„ÇíÂÖ•ÂäõÂæå„Å´„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„ÇãÂãï‰Ωú„Çí„Ç∑„Éü„É•„É¨„Éº„Éà„Åó„Åæ„Åô„ÄÇ

```javascript
// __tests__/CreateProduct.test.js
const formFileElement = screen.getByPlaceholderText(/Images/i);
const formNameElement = screen.getByPlaceholderText(/Product Name/i);
const formPriceElement = screen.getByPlaceholderText(/0.01 USDC/i);
const formImageUrlElement = screen.getByPlaceholderText(/Image URL/i);
const formDescriptionElement = screen.getByPlaceholderText(/Description/i);
const btnElement = screen.getByRole('button', {
  name: /Create Product/i,
});

/** ÂÆüË°å */
await userEvent.type(formFileElement, 'file');
await userEvent.type(formNameElement, 'name');
await userEvent.type(formPriceElement, 'price');
await userEvent.type(formImageUrlElement, 'imageUrl');
await userEvent.type(formDescriptionElement, 'description');
await userEvent.click(btnElement);
```

Á¢∫Ë™çÈÉ®ÂàÜ„Åß„ÅØ„ÄÅfetchÈñ¢Êï∞„Å®alertÈñ¢Êï∞„ÅåÊúüÂæÖ„Åô„ÇãÂºïÊï∞„ÅßÂÆüË°å„Åï„Çå„Å¶„ÅÑ„Çã„Åã„ÇíÁ¢∫Ë™ç„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ

```javascript
// __tests__/CreateProduct.test.js
/** Á¢∫Ë™ç */
expect(fetch).toBeCalledWith('../api/addProduct', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    name: 'name',
    price: 'price',
    imageUrl: 'imageUrl',
    description: 'description',
  }),
});
expect(window.alert).toBeCalledWith('Product added!');
```

„Ç®„É©„Éº„Çπ„ÉÜ„Éº„Çø„Çπ„Çí„ÉÜ„Çπ„Éà„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅfetchÈñ¢Êï∞„ÅÆÊàª„ÇäÂÄ§„Å´`errorAddedProductMock`„ÇíË®≠ÂÆö„Åó„Å¶„ÄÅalertÈñ¢Êï∞„ÅåÊúüÂæÖ„Åô„ÇãÂºïÊï∞„ÅßÂÆüË°å„Åï„Çå„Å¶„ÅÑ„Çã„Åã„ÇíÁ¢∫Ë™ç„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ

„Åù„Çå„Åß„ÅØ„ÄÅ„ÉÜ„Çπ„Éà„Çπ„ÇØ„É™„Éó„Éà„ÇíÂÆüË°å„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ`package.json`„Éï„Ç°„Ç§„É´„ÅÆjest„Ç≥„Éû„É≥„Éâ„ÇíÊõ¥Êñ∞„Åó„Åæ„Åô„ÄÇ

```json
// package.json
"scripts": {
  // ‰∏ãË®ò„Å´Êõ¥Êñ∞
  "test": "jest"
}
```

jest„Ç≥„Éû„É≥„Éâ„ÇíÊõ¥Êñ∞„Åó„Åü„Çâ„ÄÅ„Çø„Éº„Éü„Éä„É´„Åß`yarn test`„ÇíÂÆüË°å„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ

```
yarn test
```

„ÉÜ„Çπ„Éà„Åå„Éë„Çπ„Åó„Åü„Çâ„ÄÅCreateProduct„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅÆÂÆüË£Ö„ÅØÂÆå‰∫Ü„Åß„Åô„ÄÇ

![](./../../img/section-3/3_1_2.png)


### üõí ÂïÜÂìÅËøΩÂä†„Éú„Çø„É≥„ÅÆË°®Á§∫

Ê¨°„Å´„ÄÅ`index.js`„Çí‰ª•‰∏ã„ÅÆ„Å®„Åä„ÇäÊõ¥Êñ∞„Åó„Å¶„ÄÅÁôªÈå≤„Åó„Åü„Ç¢„Éâ„É¨„Çπ„Å®„É°„ÉÉ„Çª„Éº„Ç∏ÈÄÅ‰ø°ËÄÖ„ÅÆ„Ç¢„Éâ„É¨„Çπ„Åå‰∏ÄËá¥„Åô„Çã„ÅÆ„ÇíÁ¢∫Ë™ç„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åó„Çá„ÅÜÔºà„Åì„Åì„Åß„Ç∑„Éß„ÉÉ„Éó„ÅÆ„Ç™„Éº„Éä„Éº„ÇíÁ¢∫Ë™ç„Åó„Åæ„ÅôÔºâ„ÄÇ

```jsx
// index.js

import { useWallet } from '@solana/wallet-adapter-react';
import dynamic from 'next/dynamic';
import { useEffect, useState } from 'react';

import CreateProduct from '../components/CreateProduct';
import HeadComponent from '../components/Head';
import Product from '../components/Product';

// ÂèÇÁÖß: https://github.com/solana-labs/wallet-adapter/issues/648
const WalletMultiButtonDynamic = dynamic(
  async () =>
    (await import('@solana/wallet-adapter-react-ui')).WalletMultiButton,
  { ssr: false },
);

// ÂÆöÊï∞„ÇíÂÆ£Ë®Ä„Åó„Åæ„Åô„ÄÇ
const TWITTER_HANDLE = '„ÅÇ„Å™„Åü„ÅÆTwitter„Éè„É≥„Éâ„É´';
const TWITTER_LINK = `https://twitter.com/${TWITTER_HANDLE}`;

const App = () => {
  const { publicKey } = useWallet();
  const isOwner = publicKey
    ? publicKey.toString() === process.env.NEXT_PUBLIC_OWNER_PUBLIC_KEY
    : false;
  const [creating, setCreating] = useState(false);
  const [products, setProducts] = useState([]);

  const renderNotConnectedContainer = () => (
    <div>
      <img
        src="https://media.giphy.com/media/FWAcpJsFT9mvrv0e7a/giphy.gif"
        alt="anya"
      />
      <div className="button-container">
        <WalletMultiButtonDynamic className="cta-button connect-wallet-button" />
      </div>
    </div>
  );

  useEffect(() => {
    if (publicKey) {
      fetch(`/api/fetchProducts`)
        .then(response => response.json())
        .then(data => {
          setProducts(data);
          console.log('Products', data);
        });
    }
  }, [publicKey]);

  const renderItemBuyContainer = () => (
    <div className="products-container">
      {products.map((product) => (
        <Product key={product.id} product={product} />
      ))}
    </div>
  );

  return (
    <div className="App">
      <HeadComponent/>
      <div className="container">
        <header className="header-container">
          <p className="header"> üò≥ UNCHAIN Image Store üòà</p>
          <p className="sub-text">
            The only Image store that accepts shitcoins
          </p>

          {isOwner && (
            <button
              className="create-product-button"
              onClick={() => setCreating(!creating)}
            >
              {creating ? 'Close' : 'Create Product'}
            </button>
          )}
        </header>

        <main>
          {creating && <CreateProduct />}
          {publicKey ? renderItemBuyContainer() : renderNotConnectedContainer()}
        </main>

        <div className="footer-container">
          <img
            alt="Twitter Logo"
            className="twitter-logo"
            src="twitter-logo.svg"
          />
          <a
            className="footer-text"
            href={TWITTER_LINK}
            target="_blank"
            rel="noreferrer"
          >{`built on @${TWITTER_HANDLE}`}</a>
        </div>
      </div>
    </div>
  );
};

export default App;
```

„Åì„Çå„Åß„ÄÅ„Ç™„Éº„Éä„Éº„Å®Âêå„Åò„Ç¶„Ç©„É¨„ÉÉ„Éà„ÅßÊé•Á∂ö„Åô„Çã„Å®„ÄÅÂè≥‰∏ä„Å´`Create Product`„Éú„Çø„É≥„ÅåË°®Á§∫„Åï„Çå„Çã„ÅØ„Åö„Åß„Åô„ÄÇ

ÊúÄÂæå„Å´„ÄÅ„Éá„Éº„Çø„Éô„Éº„Çπ„Å´API„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíËøΩÂä†„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ

`pages/api`„Éï„Ç©„É´„ÉÄ„Å´`addProduct.js`„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„Å¶‰ª•‰∏ã„ÅÆ„Ç≥„Éº„Éâ„ÇíË≤º„Çä‰ªò„Åë„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

```jsx
// addProduct.js

import fs from 'fs';

import products from './products.json';

export default function handler(req, res){
  if (req.method === 'POST'){
    try {
      console.log('body is ', req.body)
      const { name, price, imageUrl, description, filename, hash } = req.body;

      // ÂâçÂõû„ÅÆ„Éó„É≠„ÉÄ„ÇØ„ÉàID„ÇíÂÖÉ„Å´Êñ∞„Åó„ÅÑ„Éó„É≠„ÉÄ„ÇØ„ÉàID„Çí‰ΩúÊàê„Åó„Åæ„Åô„ÄÇ
      const maxID = products.reduce(
        (max, product) => Math.max(max, product.id),
        0,
      );
      products.push({
        id: maxID + 1,
        name,
        price,
        imageUrl,
        description,
        filename,
        hash,
      });
      fs.writeFileSync(
        './pages/api/products.json',
        JSON.stringify(products, null, 2),
      );
      res.status(200).send({ status: 'ok' });
    } catch (error) {
      console.error(error);
      res.status(500).json({ error: 'error adding product' });
    }
  }
  else {
    res.status(405).send(`Method ${req.method} not allowed`);
  }
}
```

„Åì„Çå„Åß„Ç¢„Ç§„ÉÜ„É†„ÇíËøΩÂä†„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åó„Åü!

‚ÄªÂÄ§ÊÆµ„ÅÆÊ¨Ñ„Å´„ÅØÊï∞Â≠ó„Å†„Åë„ÇíÂÖ•„Çå„Çã„Çà„ÅÜ„ÄÅÊ≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

![Create Product](./../../img/section-3/3_1_1.jpg)


### üôã‚Äç‚ôÇÔ∏è Ë≥™Âïè„Åô„Çã

„Åì„Åì„Åæ„Åß„ÅÆ‰ΩúÊ•≠„Åß‰Ωï„Åã„Çè„Åã„Çâ„Å™„ÅÑ„Åì„Å®„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÄÅDiscord„ÅÆ`#solana`„ÅßË≥™Âïè„Çí„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

„Éò„É´„Éó„Çí„Åô„Çã„Å®„Åç„ÅÆ„Éï„É≠„Éº„ÅåÂÜÜÊªë„Å´„Å™„Çã„ÅÆ„Åß„ÄÅ„Ç®„É©„Éº„É¨„Éù„Éº„Éà„Å´„ÅØ‰∏ãË®ò„ÅÆ4ÁÇπ„ÇíË®òËºâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ ‚ú®

```
1. Ë≥™Âïè„ÅåÈñ¢ÈÄ£„Åó„Å¶„ÅÑ„Çã„Çª„ÇØ„Ç∑„Éß„É≥Áï™Âè∑„Å®„É¨„ÉÉ„Çπ„É≥Áï™Âè∑
2. ‰Ωï„Çí„Åó„Çà„ÅÜ„Å®„Åó„Å¶„ÅÑ„Åü„Åã
3. „Ç®„É©„ÉºÊñá„Çí„Ç≥„Éî„Éº&„Éö„Éº„Çπ„Éà
4. „Ç®„É©„ÉºÁîªÈù¢„ÅÆ„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà
```

---

„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô!

„Çª„ÇØ„Ç∑„Éß„É≥3„ÅØÁµÇ‰∫Ü„Åß„Åô!

„Åú„Å≤„ÄÅÊñ∞„Åó„ÅèËøΩÂä†„Åó„ÅüÂïÜÂìÅ„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„ÇãÁä∂ÊÖã„ÅÆWeb„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÁîªÈù¢„Çí„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„Å´ÊäïÁ®ø„Åó„Å¶„Åè„Å†„Åï„ÅÑ!

„ÅÇ„Å™„Åü„ÅÆÊàêÂäü„Çí„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„ÅßÁ•ù„ÅÑ„Åæ„Åó„Çá„ÅÜ üéâ

Ê¨°„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„Åß„ÅØ„ÄÅÊúÄÂæå„ÅÆ‰ªï‰∏ä„Åí„ÇíË°å„Å£„Å¶„ÅÑ„Åç„Åæ„Åô!
